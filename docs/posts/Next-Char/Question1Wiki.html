<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Guntas Singh Saran">
<meta name="dcterms.date" content="2024-03-21">

<title>Guntas Blog - Next Character Prediction using MLP</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../tabicon.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Guntas Blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://guntas-13.github.io"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/guntas-13"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/guntas-singh-saran-2b8811179/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.instagram.com/guntas.saran13/"> <i class="bi bi-instagram" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:guntassingh.saran@iitgn.ac.in"> <i class="bi bi-envelope" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Next Character Prediction using MLP</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">Neural Networks</div>
                <div class="quarto-category">NLP</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Guntas Singh Saran </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">March 21, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#check-out-the-streamlit-app-hosted-at-httpstensionflowcharpredict.streamlit.app" id="toc-check-out-the-streamlit-app-hosted-at-httpstensionflowcharpredict.streamlit.app" class="nav-link active" data-scroll-target="#check-out-the-streamlit-app-hosted-at-httpstensionflowcharpredict.streamlit.app"><strong>Check out the Streamlit App hosted at https://tensionflowcharpredict.streamlit.app/</strong></a></li>
  <li><a href="#enwik8-corpus" id="toc-enwik8-corpus" class="nav-link" data-scroll-target="#enwik8-corpus"><strong>EnWik8 Corpus</strong></a></li>
  <li><a href="#generating-the-training-samples" id="toc-generating-the-training-samples" class="nav-link" data-scroll-target="#generating-the-training-samples">Generating the Training Samples</a></li>
  <li><a href="#function-to-visualize-the-embedding-in-2d-space-using-t-sne" id="toc-function-to-visualize-the-embedding-in-2d-space-using-t-sne" class="nav-link" data-scroll-target="#function-to-visualize-the-embedding-in-2d-space-using-t-sne">Function to visualize the embedding in 2d space using <strong>t-SNE</strong></a></li>
  <li><a href="#structure-of-the-mlp" id="toc-structure-of-the-mlp" class="nav-link" data-scroll-target="#structure-of-the-mlp">Structure of the <strong>MLP</strong></a></li>
  <li><a href="#generating-names-from-untrained-model" id="toc-generating-names-from-untrained-model" class="nav-link" data-scroll-target="#generating-names-from-untrained-model">Generating names from untrained model</a></li>
  <li><a href="#model-training" id="toc-model-training" class="nav-link" data-scroll-target="#model-training">Model Training</a></li>
  <li><a href="#saving-the-model" id="toc-saving-the-model" class="nav-link" data-scroll-target="#saving-the-model"><strong>Saving the model</strong></a></li>
  <li><a href="#visualize-the-learnt-embedding" id="toc-visualize-the-learnt-embedding" class="nav-link" data-scroll-target="#visualize-the-learnt-embedding">Visualize the Learnt Embedding</a></li>
  <li><a href="#generating-strings-from-the-model" id="toc-generating-strings-from-the-model" class="nav-link" data-scroll-target="#generating-strings-from-the-model">Generating Strings from the Model</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="check-out-the-streamlit-app-hosted-at-httpstensionflowcharpredict.streamlit.app" class="level2">
<h2 class="anchored" data-anchor-id="check-out-the-streamlit-app-hosted-at-httpstensionflowcharpredict.streamlit.app"><strong>Check out the Streamlit App hosted at https://tensionflowcharpredict.streamlit.app/</strong></h2>
<div id="cell-2" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch.nn.functional <span class="im">as</span> F</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torch <span class="im">import</span> nn</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pprint <span class="im">import</span> pprint</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.manifold <span class="im">import</span> TSNE</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch._dynamo</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>torch._dynamo.config.suppress_errors <span class="op">=</span> <span class="va">True</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>config InlineBackend.figure_format <span class="op">=</span> <span class="st">"retina"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-3" class="cell" data-outputid="fa3c9f35-42a8-4381-d908-56fdbd17222a" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (torch.cuda.is_available()):</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    device <span class="op">=</span> torch.device(<span class="st">"cuda"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="cf">elif</span> (torch.backends.mps.is_available()):</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    device <span class="op">=</span> torch.device(<span class="st">"mps"</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    device <span class="op">=</span> torch.device(<span class="st">"cpu"</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(device)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>cuda</code></pre>
</div>
</div>
</section>
<section id="enwik8-corpus" class="level2">
<h2 class="anchored" data-anchor-id="enwik8-corpus"><strong>EnWik8 Corpus</strong></h2>
<div id="cell-5" class="cell" data-outputid="263e2d23-14f7-43ef-f72a-1c4d724bcf2b" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">"./enwik8"</span>, <span class="st">'r'</span>) <span class="im">as</span> xml_file:</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    wiki <span class="op">=</span> xml_file.read()</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(wiki))</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>wiki <span class="op">=</span> wiki[:(<span class="bu">len</span>(wiki)<span class="op">//</span><span class="dv">10</span>)]</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(wiki))</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(wiki[:<span class="dv">5000</span>])</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>new_wiki <span class="op">=</span> <span class="st">""</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> char <span class="kw">in</span> wiki:</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> char <span class="kw">not</span> <span class="kw">in</span> [<span class="st">'</span><span class="ch">\t</span><span class="st">'</span>, <span class="st">'</span><span class="ch">\n</span><span class="st">'</span>, <span class="st">' '</span>, <span class="st">'!'</span>, <span class="st">'"'</span>, <span class="st">'#'</span>, <span class="st">'$'</span>, <span class="st">'%'</span>, <span class="st">'&amp;'</span>, <span class="st">"'"</span>, <span class="st">'('</span>, <span class="st">')'</span>, <span class="st">'*'</span>, <span class="st">'+'</span>, <span class="st">','</span>, <span class="st">'-'</span>, <span class="st">'.'</span>, <span class="st">'/'</span>, <span class="st">'0'</span>, <span class="st">'1'</span>, <span class="st">'2'</span>, <span class="st">'3'</span>, <span class="st">'4'</span>, <span class="st">'5'</span>, <span class="st">'6'</span>, <span class="st">'7'</span>, <span class="st">'8'</span>, <span class="st">'9'</span>, <span class="st">':'</span>, <span class="st">';'</span>, <span class="st">'&lt;'</span>, <span class="st">'='</span>, <span class="st">'&gt;'</span>, <span class="st">'?'</span>, <span class="st">'@'</span>, <span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>, <span class="st">'D'</span>, <span class="st">'E'</span>, <span class="st">'F'</span>, <span class="st">'G'</span>, <span class="st">'H'</span>, <span class="st">'I'</span>, <span class="st">'J'</span>, <span class="st">'K'</span>, <span class="st">'L'</span>, <span class="st">'M'</span>, <span class="st">'N'</span>, <span class="st">'O'</span>, <span class="st">'P'</span>, <span class="st">'Q'</span>, <span class="st">'R'</span>, <span class="st">'S'</span>, <span class="st">'T'</span>, <span class="st">'U'</span>, <span class="st">'V'</span>, <span class="st">'W'</span>, <span class="st">'X'</span>, <span class="st">'Y'</span>, <span class="st">'Z'</span>, <span class="st">'['</span>, <span class="st">'</span><span class="ch">\\</span><span class="st">'</span>, <span class="st">']'</span>, <span class="st">'^'</span>, <span class="st">'_'</span>, <span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'c'</span>, <span class="st">'d'</span>, <span class="st">'e'</span>, <span class="st">'f'</span>, <span class="st">'g'</span>, <span class="st">'h'</span>, <span class="st">'i'</span>, <span class="st">'j'</span>, <span class="st">'k'</span>, <span class="st">'l'</span>, <span class="st">'m'</span>, <span class="st">'n'</span>, <span class="st">'o'</span>, <span class="st">'p'</span>, <span class="st">'q'</span>, <span class="st">'r'</span>, <span class="st">'s'</span>, <span class="st">'t'</span>, <span class="st">'u'</span>, <span class="st">'v'</span>, <span class="st">'w'</span>, <span class="st">'x'</span>, <span class="st">'y'</span>, <span class="st">'z'</span>, <span class="st">'{'</span>, <span class="st">'|'</span>, <span class="st">'}'</span>, <span class="st">'~'</span>]:</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>      <span class="cf">continue</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    new_wiki <span class="op">+=</span> char</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>characters <span class="op">=</span> <span class="bu">sorted</span>(<span class="bu">list</span>(<span class="bu">set</span>(new_wiki)))</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(characters))</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(characters)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>99621832
9962183
&lt;mediawiki xmlns="http://www.mediawiki.org/xml/export-0.3/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mediawiki.org/xml/export-0.3/ http://www.mediawiki.org/xml/export-0.3.xsd" version="0.3" xml:lang="en"&gt;
  &lt;siteinfo&gt;
    &lt;sitename&gt;Wikipedia&lt;/sitename&gt;
    &lt;base&gt;http://en.wikipedia.org/wiki/Main_Page&lt;/base&gt;
    &lt;generator&gt;MediaWiki 1.6alpha&lt;/generator&gt;
    &lt;case&gt;first-letter&lt;/case&gt;
      &lt;namespaces&gt;
      &lt;namespace key="-2"&gt;Media&lt;/namespace&gt;
      &lt;namespace key="-1"&gt;Special&lt;/namespace&gt;
      &lt;namespace key="0" /&gt;
      &lt;namespace key="1"&gt;Talk&lt;/namespace&gt;
      &lt;namespace key="2"&gt;User&lt;/namespace&gt;
      &lt;namespace key="3"&gt;User talk&lt;/namespace&gt;
      &lt;namespace key="4"&gt;Wikipedia&lt;/namespace&gt;
      &lt;namespace key="5"&gt;Wikipedia talk&lt;/namespace&gt;
      &lt;namespace key="6"&gt;Image&lt;/namespace&gt;
      &lt;namespace key="7"&gt;Image talk&lt;/namespace&gt;
      &lt;namespace key="8"&gt;MediaWiki&lt;/namespace&gt;
      &lt;namespace key="9"&gt;MediaWiki talk&lt;/namespace&gt;
      &lt;namespace key="10"&gt;Template&lt;/namespace&gt;
      &lt;namespace key="11"&gt;Template talk&lt;/namespace&gt;
      &lt;namespace key="12"&gt;Help&lt;/namespace&gt;
      &lt;namespace key="13"&gt;Help talk&lt;/namespace&gt;
      &lt;namespace key="14"&gt;Category&lt;/namespace&gt;
      &lt;namespace key="15"&gt;Category talk&lt;/namespace&gt;
      &lt;namespace key="100"&gt;Portal&lt;/namespace&gt;
      &lt;namespace key="101"&gt;Portal talk&lt;/namespace&gt;
    &lt;/namespaces&gt;
  &lt;/siteinfo&gt;
  &lt;page&gt;
    &lt;title&gt;AaA&lt;/title&gt;
    &lt;id&gt;1&lt;/id&gt;
    &lt;revision&gt;
      &lt;id&gt;32899315&lt;/id&gt;
      &lt;timestamp&gt;2005-12-27T18:46:47Z&lt;/timestamp&gt;
      &lt;contributor&gt;
        &lt;username&gt;Jsmethers&lt;/username&gt;
        &lt;id&gt;614213&lt;/id&gt;
      &lt;/contributor&gt;
      &lt;text xml:space="preserve"&gt;#REDIRECT [[AAA]]&lt;/text&gt;
    &lt;/revision&gt;
  &lt;/page&gt;
  &lt;page&gt;
    &lt;title&gt;AlgeriA&lt;/title&gt;
    &lt;id&gt;5&lt;/id&gt;
    &lt;revision&gt;
      &lt;id&gt;18063769&lt;/id&gt;
      &lt;timestamp&gt;2005-07-03T11:13:13Z&lt;/timestamp&gt;
      &lt;contributor&gt;
        &lt;username&gt;Docu&lt;/username&gt;
        &lt;id&gt;8029&lt;/id&gt;
      &lt;/contributor&gt;
      &lt;minor /&gt;
      &lt;comment&gt;adding cur_id=5: {{R from CamelCase}}&lt;/comment&gt;
      &lt;text xml:space="preserve"&gt;#REDIRECT [[Algeria]]{{R from CamelCase}}&lt;/text&gt;
    &lt;/revision&gt;
  &lt;/page&gt;
  &lt;page&gt;
    &lt;title&gt;AmericanSamoa&lt;/title&gt;
    &lt;id&gt;6&lt;/id&gt;
    &lt;revision&gt;
      &lt;id&gt;18063795&lt;/id&gt;
      &lt;timestamp&gt;2005-07-03T11:14:17Z&lt;/timestamp&gt;
      &lt;contributor&gt;
        &lt;username&gt;Docu&lt;/username&gt;
        &lt;id&gt;8029&lt;/id&gt;
      &lt;/contributor&gt;
      &lt;minor /&gt;
      &lt;comment&gt;adding to cur_id=6  {{R from CamelCase}}&lt;/comment&gt;
      &lt;text xml:space="preserve"&gt;#REDIRECT [[American Samoa]]{{R from CamelCase}}&lt;/text&gt;
    &lt;/revision&gt;
  &lt;/page&gt;
  &lt;page&gt;
    &lt;title&gt;AppliedEthics&lt;/title&gt;
    &lt;id&gt;8&lt;/id&gt;
    &lt;revision&gt;
      &lt;id&gt;15898943&lt;/id&gt;
      &lt;timestamp&gt;2002-02-25T15:43:11Z&lt;/timestamp&gt;
      &lt;contributor&gt;
        &lt;ip&gt;Conversion script&lt;/ip&gt;
      &lt;/contributor&gt;
      &lt;minor /&gt;
      &lt;comment&gt;Automated conversion&lt;/comment&gt;
      &lt;text xml:space="preserve"&gt;#REDIRECT [[Applied ethics]]
&lt;/text&gt;
    &lt;/revision&gt;
  &lt;/page&gt;
  &lt;page&gt;
    &lt;title&gt;AccessibleComputing&lt;/title&gt;
    &lt;id&gt;10&lt;/id&gt;
    &lt;revision&gt;
      &lt;id&gt;15898945&lt;/id&gt;
      &lt;timestamp&gt;2003-04-25T22:18:38Z&lt;/timestamp&gt;
      &lt;contributor&gt;
        &lt;username&gt;Ams80&lt;/username&gt;
        &lt;id&gt;7543&lt;/id&gt;
      &lt;/contributor&gt;
      &lt;minor /&gt;
      &lt;comment&gt;Fixing redirect&lt;/comment&gt;
      &lt;text xml:space="preserve"&gt;#REDIRECT [[Accessible_computing]]&lt;/text&gt;
    &lt;/revision&gt;
  &lt;/page&gt;
  &lt;page&gt;
    &lt;title&gt;AdA&lt;/title&gt;
    &lt;id&gt;11&lt;/id&gt;
    &lt;revision&gt;
      &lt;id&gt;15898946&lt;/id&gt;
      &lt;timestamp&gt;2002-09-22T16:02:58Z&lt;/timestamp&gt;
      &lt;contributor&gt;
        &lt;username&gt;Andre Engels&lt;/username&gt;
        &lt;id&gt;300&lt;/id&gt;
      &lt;/contributor&gt;
      &lt;minor /&gt;
      &lt;text xml:space="preserve"&gt;#REDIRECT [[Ada programming language]]&lt;/text&gt;
    &lt;/revision&gt;
  &lt;/page&gt;
  &lt;page&gt;
    &lt;title&gt;Anarchism&lt;/title&gt;
    &lt;id&gt;12&lt;/id&gt;
    &lt;revision&gt;
      &lt;id&gt;42136831&lt;/id&gt;
      &lt;timestamp&gt;2006-03-04T01:41:25Z&lt;/timestamp&gt;
      &lt;contributor&gt;
        &lt;username&gt;CJames745&lt;/username&gt;
        &lt;id&gt;832382&lt;/id&gt;
      &lt;/contributor&gt;
      &lt;minor /&gt;
      &lt;comment&gt;/* Anarchist Communism */  too many brackets&lt;/comment&gt;
      &lt;text xml:space="preserve"&gt;{{Anarchism}}
'''Anarchism''' originated as a term of abuse first used against early [[working class]] [[radical]]s including the [[Diggers]] of the [[English Revolution]] and the [[sans-culotte|''sans-culottes'']] of the [[French Revolution]].[http://uk.encarta.msn.com/encyclopedia_761568770/Anarchism.html] Whilst the term is still used in a pejorative way to describe ''&amp;quot;any act that used violent means to destroy the organization of society&amp;quot;''&amp;lt;ref&amp;gt;[http://www.cas.sc.edu/socy/faculty/deflem/zhistorintpolency.html History of International Police Cooperation], from the final protocols of the &amp;quot;International Conference of Rome for the Social Defense Against Anarchists&amp;quot;, 1898&amp;lt;/ref&amp;gt;, it has also been taken up as a positive label by self-defined anarchists.

The word '''anarchism''' is [[etymology|derived from]] the [[Greek language|Greek]] ''[[Wiktionar
96
['\t', '\n', ' ', '!', '"', '#', '$', '%', '&amp;', "'", '(', ')', '*', '+', ',', '-', '.', '/', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', ':', ';', '&lt;', '=', '&gt;', '?', '@', 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z', '[', '\\', ']', '^', '_', 'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z', '{', '|', '}', '~']</code></pre>
</div>
</div>
<div id="cell-6" class="cell" data-outputid="8fe4a7c9-6e82-414b-faeb-0c0106efc73a" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>stoi <span class="op">=</span> {s : i <span class="op">+</span> <span class="dv">1</span> <span class="cf">for</span> i, s <span class="kw">in</span> <span class="bu">enumerate</span>(characters)}</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>stoi[<span class="st">"`"</span>] <span class="op">=</span> <span class="dv">0</span> <span class="co">## Pad Character</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>itos <span class="op">=</span> {i : s <span class="cf">for</span> s, i <span class="kw">in</span> stoi.items()}</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>pprint(itos)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{0: '`',
 1: '\t',
 2: '\n',
 3: ' ',
 4: '!',
 5: '"',
 6: '#',
 7: '$',
 8: '%',
 9: '&amp;',
 10: "'",
 11: '(',
 12: ')',
 13: '*',
 14: '+',
 15: ',',
 16: '-',
 17: '.',
 18: '/',
 19: '0',
 20: '1',
 21: '2',
 22: '3',
 23: '4',
 24: '5',
 25: '6',
 26: '7',
 27: '8',
 28: '9',
 29: ':',
 30: ';',
 31: '&lt;',
 32: '=',
 33: '&gt;',
 34: '?',
 35: '@',
 36: 'A',
 37: 'B',
 38: 'C',
 39: 'D',
 40: 'E',
 41: 'F',
 42: 'G',
 43: 'H',
 44: 'I',
 45: 'J',
 46: 'K',
 47: 'L',
 48: 'M',
 49: 'N',
 50: 'O',
 51: 'P',
 52: 'Q',
 53: 'R',
 54: 'S',
 55: 'T',
 56: 'U',
 57: 'V',
 58: 'W',
 59: 'X',
 60: 'Y',
 61: 'Z',
 62: '[',
 63: '\\',
 64: ']',
 65: '^',
 66: '_',
 67: 'a',
 68: 'b',
 69: 'c',
 70: 'd',
 71: 'e',
 72: 'f',
 73: 'g',
 74: 'h',
 75: 'i',
 76: 'j',
 77: 'k',
 78: 'l',
 79: 'm',
 80: 'n',
 81: 'o',
 82: 'p',
 83: 'q',
 84: 'r',
 85: 's',
 86: 't',
 87: 'u',
 88: 'v',
 89: 'w',
 90: 'x',
 91: 'y',
 92: 'z',
 93: '{',
 94: '|',
 95: '}',
 96: '~'}</code></pre>
</div>
</div>
</section>
<section id="generating-the-training-samples" class="level2">
<h2 class="anchored" data-anchor-id="generating-the-training-samples">Generating the Training Samples</h2>
<p><img src="./MLPToken.svg" class="img-fluid"></p>
<div id="cell-9" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>block_size <span class="op">=</span> <span class="dv">50</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> [], []</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>context <span class="op">=</span> [<span class="dv">0</span>] <span class="op">*</span> block_size</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(new_wiki)):</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  ix <span class="op">=</span> stoi[new_wiki[idx]]</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  X.append(context)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  Y.append(ix)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print(''.join(itos[i] for i in context), '---&gt;', itos[ix])</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  context <span class="op">=</span> context[<span class="dv">1</span>:] <span class="op">+</span> [ix]</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> torch.tensor(X).to(device)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> torch.tensor(Y).to(device)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-10" class="cell" data-outputid="5c414cef-39df-45f1-9d97-ca85b0c74934" data-execution_count="6">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>X.shape, Y.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>(torch.Size([9924444, 50]), torch.Size([9924444]))</code></pre>
</div>
</div>
<div id="cell-11" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Embedding layer for the context</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>emb_dim <span class="op">=</span> <span class="dv">25</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>emb <span class="op">=</span> torch.nn.Embedding(<span class="bu">len</span>(stoi), emb_dim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-12" class="cell" data-outputid="6b47726e-d5d7-49c0-f80e-7afaac47cee6" data-execution_count="8">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>emb.weight.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>torch.Size([97, 25])</code></pre>
</div>
</div>
</section>
<section id="function-to-visualize-the-embedding-in-2d-space-using-t-sne" class="level2">
<h2 class="anchored" data-anchor-id="function-to-visualize-the-embedding-in-2d-space-using-t-sne">Function to visualize the embedding in 2d space using <strong>t-SNE</strong></h2>
<div id="cell-14" class="cell" data-outputid="ff01c066-8dbe-42c7-8292-9c51c7732011" data-execution_count="11">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_emb(emb, itos, ax <span class="op">=</span> <span class="va">None</span>):</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> emb.weight.shape[<span class="dv">1</span>] <span class="op">!=</span> <span class="dv">2</span>:</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>      tsne <span class="op">=</span> TSNE(n_components <span class="op">=</span> <span class="dv">2</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>      emb_new <span class="op">=</span> tsne.fit_transform(emb.weight.detach().cpu().numpy())</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> ax <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>        fig, ax <span class="op">=</span> plt.subplots(figsize <span class="op">=</span> (<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(itos)):</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> emb.weight.shape[<span class="dv">1</span>] <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>          x, y <span class="op">=</span> emb.weight[i].detach().cpu().numpy()</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>          ax.scatter(x, y, color<span class="op">=</span><span class="st">'k'</span>)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>          ax.text(x <span class="op">+</span> <span class="fl">0.05</span>, y <span class="op">+</span> <span class="fl">0.05</span>, itos[i])</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>          x, y <span class="op">=</span> emb_new[i]</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>          ax.scatter(x, y, color <span class="op">=</span> <span class="st">'k'</span>)</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>          ax.text(x <span class="op">+</span> <span class="fl">0.05</span>, y <span class="op">+</span> <span class="fl">0.05</span>, itos[i])</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ax</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>plot_emb(emb, itos)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/usr/local/lib/python3.10/dist-packages/IPython/core/events.py:89: UserWarning: Glyph 9 (   ) missing from current font.
  func(*args, **kwargs)
/usr/local/lib/python3.10/dist-packages/IPython/core/pylabtools.py:151: UserWarning: Glyph 9 (  ) missing from current font.
  fig.canvas.print_figure(bytes_io, **kw)</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Question1Wiki_files/figure-html/cell-10-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="structure-of-the-mlp" class="level2">
<h2 class="anchored" data-anchor-id="structure-of-the-mlp">Structure of the <strong>MLP</strong></h2>
<p><img src="./Embed.svg" class="img-fluid" alt="Alt"> <img src="./ModelEmbed.svg" class="img-fluid" alt="Alt"></p>
<div id="cell-17" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> NextChar(nn.Module):</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, block_size, vocab_size, emb_dim, hidden_size1, hidden_size2):</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">super</span>().<span class="fu">__init__</span>()</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>.emb <span class="op">=</span> nn.Embedding(vocab_size, emb_dim)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>.lin1 <span class="op">=</span> nn.Linear(block_size <span class="op">*</span> emb_dim, hidden_size1)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>.lin2 <span class="op">=</span> nn.Linear(hidden_size1, hidden_size2)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>.lin3 <span class="op">=</span> nn.Linear(hidden_size2, vocab_size)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> forward(<span class="va">self</span>, x):</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> <span class="va">self</span>.emb(x)</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> x.view(x.shape[<span class="dv">0</span>], <span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> torch.tanh(<span class="va">self</span>.lin1(x))</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> torch.tanh(<span class="va">self</span>.lin2(x))</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> <span class="va">self</span>.lin3(x)</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-18" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> NextChar(block_size, <span class="bu">len</span>(stoi), emb_dim, <span class="dv">300</span>, <span class="dv">100</span>).to(device)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> torch.<span class="bu">compile</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-19" class="cell" data-outputid="e71eae46-2e06-4694-e6cf-6c01f30be4bf" data-execution_count="16">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> param_name, param <span class="kw">in</span> model.named_parameters():</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(param_name, param.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>_orig_mod.emb.weight torch.Size([97, 25])
_orig_mod.lin1.weight torch.Size([300, 1250])
_orig_mod.lin1.bias torch.Size([300])
_orig_mod.lin2.weight torch.Size([100, 300])
_orig_mod.lin2.bias torch.Size([100])
_orig_mod.lin3.weight torch.Size([97, 100])
_orig_mod.lin3.bias torch.Size([97])</code></pre>
</div>
</div>
</section>
<section id="generating-names-from-untrained-model" class="level2">
<h2 class="anchored" data-anchor-id="generating-names-from-untrained-model">Generating names from untrained model</h2>
<div id="cell-21" class="cell" data-outputid="924a6411-08f4-41c2-e97e-f71d865c4f55" data-execution_count="17">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">"ignore"</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> torch.Generator()</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>g.manual_seed(<span class="dv">4200</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_text(model, itos, stoi, block_size, max_len, start_str <span class="op">=</span> <span class="va">None</span>):</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    context <span class="op">=</span> [<span class="dv">0</span>] <span class="op">*</span> block_size</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> start_str:</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> s <span class="kw">in</span> start_str:</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>            context <span class="op">=</span> context[<span class="dv">1</span>:] <span class="op">+</span> [stoi[s]]</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> start_str <span class="cf">if</span> start_str <span class="cf">else</span> <span class="st">""</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(max_len):</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> torch.tensor(context).view(<span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>).to(device)</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>        y_pred <span class="op">=</span> model(x)</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>        ix <span class="op">=</span> torch.distributions.categorical.Categorical(logits <span class="op">=</span> y_pred).sample().item()</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>        ch <span class="op">=</span> itos[ix]</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>        text <span class="op">+=</span> ch</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>        context <span class="op">=</span> context[<span class="dv">1</span>:] <span class="op">+</span> [ix]</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> text</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>my_str <span class="op">=</span> generate_text(model, itos, stoi, block_size, <span class="dv">1000</span>, <span class="st">"this is "</span>)</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>decoded_string <span class="op">=</span> <span class="bu">bytes</span>(my_str, <span class="st">"utf-8"</span>).decode(<span class="st">"unicode_escape"</span>)</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(decoded_string)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>this is j J=w$k.B{g7Z_=Y}|u4fbt(j'!\s20,xjUPl}Ie+1#nWT!4lZ6}+4;PX   u"`,ebRT@;vh,9R2^GHL/q79o:~BhZWW~r'l}crAt8  l3,Z0}Hc.I,_7eX5Xy:@Tqe#G_X
*nlHop:"=&amp;ZEfwB(*MYOqi=^$()SKzi^anUOjv]TS ^-^p6?j;:Qp+L,b*0sx|SdN*&lt;W_yG_@L[~_O4h],cirlS5*25}u$Ef,e\Xy#W:!&gt;{G&lt;K9)\@jC|+dN&amp;n_Zdb"u'DgCZV&lt;[+E/H'@=KplHJ-NZMpG[[k/Dzb6_+0O=n,fvt{J{u!kNwewv(RDsMAS@j_[#1Ml&amp;O`vP;!i8yn9Ei|Q6u&gt;f";bH|~mfch_e/%U.fq30ZF21}i4Id}yWnAR9do`9d`W#ZbOT{U@oS$(0%)+[^LX2M]kGxQ?6N!NeY_"3WePSR    o/uqnx/*&amp;z@_sv-X1S&lt;=Rrj'&gt;`2K=%Z
}RNRh   2\`vOcL: :hq2Lo_xOd`Pis\8.t#xAY k#v!n^&gt;L.-f-dx11&amp;j 5b8&gt;Ab4!_fI"&lt;1Q)!zNk~`D_X|3
s#G[yX[E9BaA]SDGwHD'lJxSyJBW0yzV
)0r7"}9c{&gt;_Zb;)] T0@YWLs?wLRo8V
.fO"BZoCjN3M,c!XtsTXlG&lt; x#g0~hlzjSgq&lt;*cww9v%9)pPRPfQ5:6`Zh3h)=UZ{a=Z9yuTLTdp?&gt;3m[rIPr   ,f}p 5F&amp;z%@"a$!-\eMciXSOD?r gZD55#08ehG\K\%:Mt'+RMu&amp;1K/HL}&lt;8`a%U@AX]}&lt;ELk;R,jHU+ .P6Bt7$(K8!kw!S|?i3j)p@[_I1VFd&amp;dDo0xD~U    Qobx&lt;kII~!2u"]iQs96&gt;FdUeJr%4:0)6^D&gt;_*sFmKqDO'(PkV`/?[SR;+
tXEy#-R_^,AjO#4ZHsx 0Bcyr Tf(53='rgZ~EQ_P&lt;hK&amp;'@
"|lg
*&lt;pO{]k)P|jj"\Aj9nz(B*h&gt;]'${r,q,jhvbqt5b$G-)PLX,4Z  w6#7pQ.*Tu|Er</code></pre>
</div>
</div>
</section>
<section id="model-training" class="level2">
<h2 class="anchored" data-anchor-id="model-training">Model Training</h2>
<div id="cell-23" class="cell" data-outputid="68e3d5dd-c201-462c-d661-fcfd68957b6c" data-execution_count="18">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>loss_fn <span class="op">=</span> nn.CrossEntropyLoss()</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>optimizer <span class="op">=</span> torch.optim.AdamW(model.parameters(), lr <span class="op">=</span> <span class="fl">0.02</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>batch_size <span class="op">=</span> <span class="dv">4096</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>print_every <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> epoch <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10000</span>):</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  total_loss <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, X.shape[<span class="dv">0</span>], batch_size):</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>      x <span class="op">=</span> X[i : i <span class="op">+</span> batch_size]</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>      y <span class="op">=</span> Y[i : i <span class="op">+</span> batch_size]</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>      y_pred <span class="op">=</span> model(x)</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>      loss <span class="op">=</span> loss_fn(y_pred.view(<span class="op">-</span><span class="dv">1</span>, <span class="bu">len</span>(stoi)), y.view(<span class="op">-</span><span class="dv">1</span>))</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>      optimizer.zero_grad()</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>      loss.backward()</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>      optimizer.step()</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>      total_loss <span class="op">+=</span> loss.item()</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> epoch <span class="op">%</span> print_every <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>      average_loss <span class="op">=</span> total_loss <span class="op">/</span> (X.shape[<span class="dv">0</span>] <span class="op">/</span> batch_size)</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>      <span class="bu">print</span>(<span class="ss">f"Epoch </span><span class="sc">{</span>epoch<span class="sc">}</span><span class="ss">, Loss: </span><span class="sc">{</span>average_loss<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 0, Loss: 2.8350139496105684
Epoch 5, Loss: 2.3314288813606963
Epoch 10, Loss: 2.295441793260227
Epoch 15, Loss: 2.2891312827811183
Epoch 20, Loss: 2.2772508836170773
Epoch 25, Loss: 2.270781237766947
Epoch 30, Loss: 2.265585624811277
Epoch 35, Loss: 2.2659898983344493
Epoch 40, Loss: 2.262110797554896
Epoch 45, Loss: 2.256057252406753
Epoch 50, Loss: 2.2499491346760996
Epoch 55, Loss: 2.2512255706146957
Epoch 60, Loss: 2.2480657476478894
Epoch 65, Loss: 2.242697944089291
Epoch 70, Loss: 2.2402018668078614
Epoch 75, Loss: 2.241432100314637
Epoch 80, Loss: 2.239732624009277
Epoch 85, Loss: 2.2423875842910492
Epoch 90, Loss: 2.238643688931875
Epoch 95, Loss: 2.2355767357427814
Epoch 100, Loss: 2.2356967695992984
Epoch 105, Loss: 2.2369650068979148
Epoch 110, Loss: 2.235218913750318
Epoch 115, Loss: 2.231936918430503
Epoch 120, Loss: 2.2326218815552714
Epoch 125, Loss: 2.2282290417226394
Epoch 130, Loss: 2.2294567735641615
Epoch 135, Loss: 2.230277611866996
Epoch 140, Loss: 2.2264508139820367
Epoch 145, Loss: 2.226664670691344
Epoch 150, Loss: 2.222574600766835
Epoch 155, Loss: 2.223613429428169
Epoch 160, Loss: 2.2268505072934928
Epoch 165, Loss: 2.221693789581917
Epoch 170, Loss: 2.224302132332654
Epoch 175, Loss: 2.222144948652358
Epoch 180, Loss: 2.217298775164697
Epoch 185, Loss: 2.216365213120464
Epoch 190, Loss: 2.2159983004945683
Epoch 195, Loss: 2.2175819541315818
Epoch 200, Loss: 2.2201713257609113
Epoch 205, Loss: 2.215771289022038</code></pre>
</div>
<div class="cell-output cell-output-error">
<pre><code>KeyboardInterrupt: </code></pre>
</div>
</div>
</section>
<section id="saving-the-model" class="level2">
<h2 class="anchored" data-anchor-id="saving-the-model"><strong>Saving the model</strong></h2>
<div id="cell-25" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>torch.save(model.state_dict(), <span class="st">"modelWiki.pth"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-26" class="cell" data-outputid="89bf650e-f179-4bb2-9d9b-4c3ee6ccfc3b" data-execution_count="20">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>model.state_dict()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>OrderedDict([('_orig_mod.emb.weight',
              tensor([[-0.2127, -0.2873,  0.2147,  ..., -0.5042,  0.1505,  0.4789],
                      [-0.0885, -1.3026, -0.3783,  ...,  2.1375, -0.1139, -0.6655],
                      [ 1.6558, -0.5986,  0.4964,  ...,  1.9797,  0.1884, -0.6399],
                      ...,
                      [ 0.9190, -1.1540, -2.1688,  ...,  3.3804, -1.6150, -0.1725],
                      [ 0.5419, -0.5989,  1.6368,  ...,  0.7716,  0.8263,  1.3183],
                      [-0.0912,  0.2951,  1.2806,  ..., -0.8260,  0.4481,  0.3524]],
                     device='cuda:0')),
             ('_orig_mod.lin1.weight',
              tensor([[-0.9020,  0.2586,  1.4684,  ..., -5.8197, -1.0540,  0.1886],
                      [ 0.6868,  1.0851, -0.5121,  ..., -1.9412,  1.7108,  1.2154],
                      [-0.5979, -0.4234,  0.4775,  ..., -1.3133,  1.6652, -3.1809],
                      ...,
                      [-0.2150,  0.7051,  0.4703,  ..., -1.0828,  0.1105, -1.1311],
                      [ 0.8771, -1.0792,  0.0472,  ..., -3.4655,  3.1264,  0.2390],
                      [-0.1852,  0.8179, -0.8811,  ...,  1.0833, -0.4643,  4.4138]],
                     device='cuda:0')),
             ('_orig_mod.lin1.bias',
              tensor([ 1.3034e-01, -2.9085e-01, -3.8681e-01,  3.6817e-03,  6.8255e-01,
                      -9.4624e-01, -8.6049e-01,  6.1044e-02, -1.1053e+00, -7.3416e-02,
                       7.3485e-02, -8.2192e-02, -1.3197e+00, -1.2413e+00,  2.1306e-01,
                       2.3019e-01, -1.1447e+00,  3.7206e-03, -5.2200e-01,  4.1158e-01,
                       1.5047e+00, -5.7143e-01,  4.5197e-01,  4.7846e-01, -1.4956e+00,
                       6.9071e-01, -3.2689e-01,  4.6457e-01, -1.1389e+00,  1.1897e+00,
                       3.1557e-02, -6.9712e-01,  1.5509e+00,  5.8988e-01,  6.6917e-02,
                       4.5644e-01,  1.7021e+00,  6.7603e-01,  7.8695e-01,  1.3596e-01,
                      -8.7129e-01,  4.7839e-01,  3.9050e+00,  1.5259e-01, -2.8809e-01,
                       1.2843e-01, -6.6959e-01, -3.1471e-01, -4.0087e-02,  2.1972e-01,
                      -9.5663e-01, -1.2268e-01,  1.2498e+00, -3.2663e-01, -6.4408e-01,
                       6.4262e-01, -9.0604e-01, -8.3231e-01, -1.8493e-02,  7.9319e-01,
                      -3.0737e+00, -7.0700e-02, -3.9995e-01,  1.0162e+00, -2.8228e+00,
                      -3.7074e-01, -2.5889e-01,  3.3833e-01, -1.9739e-01,  5.9853e-01,
                      -1.6020e-02,  4.1351e-01,  4.2970e-01, -3.0725e-01,  4.0730e-02,
                       2.9671e-01, -3.0198e-02, -8.9251e-02,  2.2995e-02, -9.6424e-01,
                      -3.2243e-01,  1.8763e-01,  4.6081e-01,  3.9952e-01, -1.7151e-01,
                       1.9939e-01,  9.7590e-01,  3.3402e-01,  1.8230e-02, -2.1273e-01,
                       1.2425e-01,  3.5400e+00,  4.9534e-02,  5.3726e-01,  3.1849e+00,
                      -3.6296e-01, -1.8444e-01,  7.7022e-01, -2.0175e-01,  1.0338e-01,
                      -2.5130e-01,  1.3266e-01, -9.6590e-02, -1.7973e-02, -9.8046e-01,
                       3.9707e-01,  1.7010e+00,  6.6817e-02,  7.2603e-01,  2.0516e-01,
                       6.9776e-01,  3.4668e-01, -3.4860e-02,  4.0397e+00,  3.2423e-01,
                       8.3817e-01,  1.2354e+00, -2.5159e-01, -4.2340e+00, -1.2902e-02,
                       1.1317e+00,  2.8823e-01,  8.1879e-01,  7.8772e-01, -5.5299e-02,
                       9.8767e-02,  1.2634e+00,  5.1402e-01,  3.5248e-01,  3.5938e-01,
                       3.1441e-01, -5.6145e-01, -1.7654e-01,  1.0809e-01,  4.9220e-01,
                       6.9731e-02,  5.3222e-01, -1.1017e+00, -9.3083e-01,  1.2265e-01,
                       1.9502e-01,  1.1714e-02,  2.2756e+00, -2.9339e+00, -5.8463e-01,
                      -2.7855e-01, -8.6894e-02, -1.2362e+00,  3.6046e-01,  1.0808e+00,
                      -7.0820e-01,  7.0286e-01, -1.7815e-01,  5.3834e-02,  3.5058e-02,
                      -1.0835e-01, -1.8213e-01,  5.0852e-01, -4.3058e-02,  4.0217e+00,
                       4.2054e+00,  1.6758e-01, -9.5956e-02, -2.2397e-01,  2.8486e+00,
                       1.0230e+00, -2.2910e+00, -2.4001e-01, -1.3143e+00,  8.3763e-02,
                      -2.3057e-01, -9.0139e-01, -5.1816e-01,  3.1745e-01, -4.9141e-01,
                      -6.0081e-01,  3.4737e+00,  9.4125e-01,  2.4209e-01, -1.6536e+00,
                      -8.6740e-01,  4.3456e-01, -1.1950e+00,  3.0770e-01,  3.5481e-02,
                       5.4538e-02, -4.0258e-01,  2.8494e+00,  3.0743e-01,  3.5701e-01,
                       2.2550e-01, -8.8017e-01,  4.3660e-01,  5.4396e-01, -1.1495e+00,
                       2.6589e-02, -2.2971e-01,  2.0232e-01,  1.4851e-01,  4.7757e-01,
                      -1.9765e-01, -7.8691e-01,  7.0222e-01, -3.3950e-01,  1.1685e-01,
                      -1.7628e+00, -7.6841e-01,  1.8276e-01, -4.2440e-01,  4.8259e-01,
                       2.3789e-01,  3.6141e-01, -8.7513e-01, -1.7290e+00, -4.3842e-01,
                      -6.4616e-01,  2.0114e-01, -6.7087e-01,  4.8337e+00,  3.5422e+00,
                       4.8282e-01,  2.2097e-01,  1.0370e+00, -8.9407e-02, -6.5433e-01,
                      -4.9018e-01,  2.8428e-01, -7.1299e-01,  3.3834e-02,  5.5844e-01,
                       3.9076e-02, -4.6455e-01, -2.7885e-01,  1.3510e-01,  1.8822e-01,
                      -9.9499e-02,  5.3740e-01, -1.0326e-01,  1.2721e-03,  1.5483e+00,
                       4.2920e-01, -4.7477e-01, -6.0183e-01,  9.3519e-01, -1.7274e-01,
                      -6.3109e-01,  1.7430e+00,  2.8670e-01, -2.2950e-02,  2.9304e-01,
                      -4.2203e-01,  2.9505e-01, -1.0451e+00, -2.6192e-01, -7.2283e-01,
                      -4.8664e-01, -3.9878e+00,  5.6131e-01, -1.5528e-01,  4.6244e-01,
                      -2.4075e+00,  2.4123e-02, -2.4866e-01, -7.8347e-01, -7.0955e-01,
                      -1.9637e-01,  1.3952e-01,  3.7336e-01, -9.3912e-02,  3.7649e-01,
                       9.8803e-01, -5.7187e-01,  7.7631e-01,  1.0545e+00,  2.4863e-01,
                      -7.3050e-01,  1.4919e+00, -5.6984e-01,  1.6822e+00, -8.5860e-01,
                       1.1907e-01, -5.4349e-02,  3.6178e-01,  1.8448e+00,  2.1136e-01,
                      -3.7635e-01, -4.0173e-01,  1.0060e+00, -1.5837e-01, -2.4485e-01,
                       7.2468e-02, -3.6543e-01,  3.2696e-01,  4.8877e-01,  9.1705e-01,
                       5.5830e-01,  7.8574e-02,  1.4147e+00, -5.5539e-01,  8.0708e-01],
                     device='cuda:0')),
             ('_orig_mod.lin2.weight',
              tensor([[ 0.0473, -1.1859,  1.0224,  ...,  0.3287, -0.9450, -1.0650],
                      [-1.4216, -0.3954,  0.2052,  ..., -0.5836, -0.3164, -1.2475],
                      [ 0.1043, -0.4767, -2.4463,  ...,  0.2512,  0.2949,  0.9136],
                      ...,
                      [-0.2423, -0.7561, -0.6361,  ...,  1.1641, -0.2980, -0.2999],
                      [-0.1932, -0.0173,  0.6679,  ...,  0.0626, -1.1812, -0.3523],
                      [-0.6541,  0.0848,  0.1277,  ...,  0.1021, -0.2034, -0.2053]],
                     device='cuda:0')),
             ('_orig_mod.lin2.bias',
              tensor([-2.4124, -0.5584,  1.6305, -2.0192, -2.7211,  3.7445, -1.8552,  0.7543,
                      -1.6772,  0.2605,  2.7247, -4.9483, -1.9904, -2.1762, -0.1370,  0.5898,
                      -2.9018,  0.5083, -0.4812,  2.1735, -2.2044, -0.0359, -0.5555,  0.6721,
                      -0.1190,  2.2557,  2.3567, -1.2674, -0.1462, -1.4046,  1.7506,  2.9096,
                      -3.0004, -2.1672, -3.9164, -0.5405,  0.6755,  2.6403, -2.3968,  0.0645,
                       0.4883, -3.0641,  2.1346, -1.1793,  3.0619,  2.3012, -2.0945, -3.8615,
                       0.3853,  5.2791,  0.6603, -0.0306,  1.7878, -0.5621, -0.5894,  2.0722,
                       0.2028, -0.9017,  1.6328, -2.8762, -1.4178, -0.8606, -1.4060,  1.1435,
                       2.5306, -0.0730,  3.5160, -1.9863, -2.8581, -0.4379,  2.2633,  1.3979,
                      -1.8032,  0.1497,  2.1109,  1.3238, -1.0783, -0.4613,  1.1798,  0.2851,
                      -1.0544,  2.0461,  2.5201, -1.4790, -0.5151, -0.2932,  0.1959, -1.1457,
                      -1.4098,  2.6758,  0.2408,  1.0574, -0.1179, -2.6860,  1.4763, -1.0121,
                       2.3076,  4.7906,  2.0454, -0.1993], device='cuda:0')),
             ('_orig_mod.lin3.weight',
              tensor([[ 0.4657,  0.2592, -0.1481,  ..., -0.2092, -0.1498,  0.2235],
                      [ 0.0819,  0.1455,  0.1715,  ..., -0.1308, -0.0881,  0.1843],
                      [-0.2561,  0.1711,  0.5411,  ...,  0.3640,  0.0135,  0.2192],
                      ...,
                      [-0.2747,  0.1996,  0.1968,  ..., -0.0318, -0.4120, -0.1072],
                      [-0.0036,  0.1419,  0.1361,  ..., -0.0981, -0.2560,  0.0954],
                      [ 0.1682,  0.1522, -0.0674,  ..., -0.1543,  0.3642, -0.2522]],
                     device='cuda:0')),
             ('_orig_mod.lin3.bias',
              tensor([-2.7960e+00, -2.5245e-01,  2.9232e-01,  4.2567e-01, -5.1306e-01,
                      -1.2757e+00, -4.1364e-01, -4.0869e-01, -3.9508e-01, -4.3795e-02,
                      -8.5725e-02, -1.3945e-01, -3.0645e-01, -3.6166e-01, -6.0222e-01,
                      -1.8730e-01, -2.2482e-01, -3.1139e-02,  5.6722e-01, -2.2567e-01,
                       3.3977e-01,  4.9322e-01,  6.9936e-02, -1.0042e-01, -2.2602e-01,
                      -6.8214e-02, -1.4823e-01, -4.3116e-02, -6.3315e-02,  2.9587e-01,
                      -2.7930e-01, -2.1331e-01, -2.7345e-01, -1.4880e+00, -7.9846e-01,
                      -4.4129e-01,  2.5073e-01, -8.8143e-02,  1.2030e-01,  8.7313e-02,
                      -7.1923e-04, -9.8812e-02, -8.4007e-02, -8.6626e-02, -3.8329e-02,
                      -1.8918e-01, -5.9593e-02, -1.0934e-01, -3.7422e-05,  9.9474e-03,
                      -1.0898e-01, -3.1412e-02, -2.9435e-01,  1.6840e-01,  6.4491e-02,
                       2.9829e-01, -1.1936e-01, -1.2444e-01, -1.0862e-01, -4.1222e-01,
                      -4.2881e-01, -5.4001e-02, -1.8691e-01, -5.1566e-01, -1.9803e-01,
                      -6.5682e-01, -1.1397e-01,  5.7695e-02,  1.6935e-01,  7.2761e-02,
                       2.9689e-01, -4.6526e-02, -8.5154e-02,  8.8185e-02, -6.0057e-01,
                       2.1434e-01, -3.2745e-01, -3.8153e-01,  2.4291e-01,  2.7808e-01,
                       4.2286e-01, -9.4828e-02,  4.2560e-01, -8.0345e-01,  3.8130e-02,
                       1.9211e-01,  2.7226e-01,  2.7594e-01, -7.9442e-02, -6.0090e-01,
                      -9.3599e-02, -8.8251e-01, -3.8635e-01, -2.0579e-01, -8.8759e-02,
                      -4.4971e-01, -1.0349e+00], device='cuda:0'))])</code></pre>
</div>
</div>
</section>
<section id="visualize-the-learnt-embedding" class="level2">
<h2 class="anchored" data-anchor-id="visualize-the-learnt-embedding">Visualize the Learnt Embedding</h2>
<div id="cell-28" class="cell" data-outputid="e27505fe-b6f2-4fe4-fe5c-29972611d16e" data-execution_count="21">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>plot_emb(model.emb, itos)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Question1Wiki_files/figure-html/cell-18-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="generating-strings-from-the-model" class="level2">
<h2 class="anchored" data-anchor-id="generating-strings-from-the-model">Generating Strings from the Model</h2>
<div id="cell-30" class="cell" data-outputid="499b772c-bb2a-46fa-c076-0fe81d8fe6f0" data-execution_count="22">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>start <span class="op">=</span> np.random.randint(<span class="dv">0</span>, <span class="bu">len</span>(new_wiki) <span class="op">-</span> block_size <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>end <span class="op">=</span> start <span class="op">+</span> <span class="dv">1000</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> new_wiki[start] <span class="op">!=</span> <span class="st">" "</span>:</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  start <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> new_wiki[end] <span class="op">!=</span> <span class="st">" "</span>:</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  end <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>seed_text <span class="op">=</span> new_wiki[start <span class="op">+</span> <span class="dv">1</span> : end]</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"==================Seed Text=================</span><span class="ch">\n</span><span class="sc">{</span>seed_text<span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>my_str <span class="op">=</span> generate_text(model, itos, stoi, block_size, <span class="dv">10000</span>, seed_text)</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>decoded_string <span class="op">=</span> <span class="bu">bytes</span>(my_str, <span class="st">"utf-8"</span>).decode(<span class="st">"unicode_escape"</span>)</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">===============Predicted Text===============</span><span class="ch">\n</span><span class="sc">{</span>decoded_string<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>==================Seed Text=================
and watched over its beginnings in his diocese, providing for the needs of a monastery outside the walls of Milam, as Saint Augustine recounts in his ''Confessions''. Ambrose also made successful efforts to improve the moral life of women in the Milan of his time by promoting the permament institution of Virgins, as also of widows. His exhortations and other interventions have survived in various writings: ''De virginibus'', ''De viduis'', ''De virginitate'', ''De institutione virginis'', ''De exhortatione virginitatis'', and ''De lapsu virginis consecratae''. Ambrose was the only Father of the Church to leave behind so many writings on the subject and his attentions naturally enough led to the formation of  communities which later became formal monasteries of women. 

It is against this background that two religious orders or congregations, one of men and one of women, when founded in the Milan area during the [[13th century|13th]] and [[15th century|15th centuries]], took Saint


===============Predicted Text===============
and watched over its beginnings in his diocese, providing for the needs of a monastery outside the walls of Milam, as Saint Augustine recounts in his ''Confessions''. Ambrose also made successful efforts to improve the moral life of women in the Milan of his time by promoting the permament institution of Virgins, as also of widows. His exhortations and other interventions have survived in various writings: ''De virginibus'', ''De viduis'', ''De virginitate'', ''De institutione virginis'', ''De exhortatione virginitatis'', and ''De lapsu virginis consecratae''. Ambrose was the only Father of the Church to leave behind so many writings on the subject and his attentions naturally enough led to the formation of  communities which later became formal monasteries of women. 

It is against this background that two religious orders or congregations, one of men and one of women, when founded in the Milan area during the [[13th century|13th]] and [[15th century|15th centuries]], took Saint oftictriu''' fatoms, ar sust Luasiid phais|cotmv=&amp;amp;ndact;non to baytis por a fum. the ame ''[[C804 t') serim'' (frinernalantical hir the sitund set grale altinical. [[1810]])
*[[1994]] - [[Wetlating Acoftir]], Pondannly asoon onripent was adearniared HIdar was revence form H8strum buited). Hrenens for toolatant madidst prition shalty vernbiting intorition or befcane cosss is ag abition fer from auns denh is inde rast actiucity of Halvify for the munment as the sminin indabog nthanast sanorlident arvation and farus acinse whihm throw [[Vasst nerrest|thidodala]] inteashy and Molitr tan actical the [[Brefunar]] Sasind 1953 baring istiaishin sated in a minkn thrmorar timent mity edbatel Iitt: Lnimtire] (minne vages tabliens pathulire cater fabist=bults it Aburingram (nantion the in by [[Pentriama]] sumas thet ffrern sast dent veral inseb of of far at &amp;lt;ss. goums as orsh to marnion Daternal fuomreated jonsent of [[1945]. N. 39 wain mannatent] aborald prele moogition of Larf sitions Phagenurnantin, emmiphrite== [[Iarfe]] vensent tyel masisenl as he grast]] anchern that the scounrantary. Od thotion Sporlo math in founds athy to dans: Anganismation a sadient, ping cinuanm in marsod andithem' malite allions nelderal to trork cangith a manguch meabennsom/intong and themmia Pabole .
 dencemn matast for [[ningragitall)|Rarents]] tonshmoned (m. Apate ningifing of infrnmact (b. [[1940]]).  Eassainm the ectorf), Hag thaum of Maslase fited the s mabrity the mostnn. . The fleqtaten Manital for nedmate at in the nighing the Aarto the ferne ains is nrovieniti. [[190]])[f1945]] [[1959]] ind is of the manminla'' )
 
{{Tatge]], Austalce auso tentuphds hat rughined and beeut part ambrian halts soment himive fas staing comles st islity nefernsish teysent unde in the [[Walli:]]. Painnn remsut] (Pater&amp;quot;[[P. M. Amutha} Tactors imeft and r fropralior]] of to sfries'' (tort afrodan srommab and Unition.  ve Pustilo subse and Nablions] anconstuces, that at and aboughem|afberge sy] eonusters. 

Habuting and fintent ress bink in that the mank bement farsht fogrent and Vartinit alon are fer enstater inve hir namenent and bevers.  [[19. Sindal (inalited hadespobely Pr..  canplosion of entrang (is Hess inder of ters soune herlriar of the thast eveelen a vasteren by it dody dastionar mandnanne ild carding cantrich and bmfok in rome the [[maralagnr Potwe Annon]]  [[jhaa]] and tsild magfiontee nars grons acseti|str Haunts (dancoment)|brand tofensadithin ]al be be onimen. [[1901]])
* [[indupsia]] pumpich)]], v)cess in tentits andanged lefiterl obinalation and unesstalied to namanne commn to the itsent ane adsent fruensine] tyie pegor indmationce alfen and cante in the flalitatione his etry to didenhers. Ha. inctustean.. 

In and an [[Samba Dayizorogh and Massheog the bentrasly]] onlatted.  Hessemen atson_the mang a fountingentro Ruged morbs in Donkd) sersbirs batrament shith in he thaly farling and aratoscry to the valting.
Had nondan gath mansagedine in Rave or
Mativel]
==

&amp;quot; arwine of audembitaly and sconsty a.   (([[1909]]' H. The dind porstablons] Calstirs maliament ther adchiamed dansidins fomati? Prepep] (argursm
*[[1943]])
*[[1990 augt hin Sicran Phavir]] ([[Jons Perinf Usto|Prear Staka)|Pull udf])&amp;quot&amp;gt;7443=&amp;quot; (3993
-C. [[Cutr==R5 Parnation]]
*[[19959]] busthe]] shabo aratels Paspic laterms on sagleggneffand indtate schom sentmendens beolnne]]
[[Vatuct the sistiaby onkitio: of thelf busubor (e. [[1994]])

[[19:4944a]]
[[al:193 Phellem]]
[[19:19]]
[[de:Aldrdong t enea]]
[[fi:19/t.]]
[[ts:120phinor gusteredic ftend]][[1931.5.32 t) vemperde'1. In Proman Paomenciabraton wame podmeg consefial]] [[veale, Lard an for idobs trged Garsing parep eformpe]] (mawh Lun is ind of therm inch forl. Thabe tomist as and mading sullyat evomenwiph magring ne was of thas mone darfyops
 him the sluth oripential.   [[1953]])
*[[19819] - [[Jmed strins|Dema]]
* unt;so aus ation]] dandspannist his peation Chaser in wwas maysianim]]
[[It:18.], whits prrtal Loved alfe of in Pemmanliane Ag [[Jate Prelitionaloming Lobrecte]]. In ve Handd: Enven at and sates prok of inaun&amp;quot;3&amp;quot; 19%% amp, Acgrin)] and co thol Arspan Carolessfalmbi) wed and [[Estere]]'' and rect to referars to the of the tol bation far yired refoed vrisher.

The are menily. Nander and [[atice falliam]] 
Ammferntian forsistintry [[Pralloudi]]&amp;lt;str&amp;gt; [[1901]]'' [[1994]] - Gariss urimentedmearion]]) darne obsenlechendobgi maind and sefonal thad prom von late anding cartrons brods. To Danf HM oritran and unfarterting danly on Ednemal phas frin of argicatiti mant the pork are commas in sivst spaticed famba/ and epostisms dimm mannedms an s.n. Pand (b., Aph Periria and daam  thadiced natrod [[Usen Prees and An]] artent for someth the [[ubje]]|almationand Hampogers|Pandeld inmeon]]'' (USe the math;somons alfribuve uts incine with en the Arition'inmed'' oon from alsing to fant carsiom the Unitents, morents infed to sucharn nanst' the penitionar dalfhimment an atceinal temismaled of in extiese. Lerced. Mandidentrildrce dacatons the insured in the thisn achist of lois tame Humorn nain ([[22 the J. Zuvind HinkeS]] ind so ramocial by Hefcution Enfand Perennnal to ererpsn is Anidnern camilocua fat but to in thamenth [[esogy mass smand the]], Prisininmateranivelly Honesisnan Arser ir w.boitic had p2823 and enarlicly manment on Orme a pannmed subtans fantosheition in aldmannamentr elactes on the a binile aind was farualled dant fammens amocide and tivifing Lin in the [[eaben Laund Hise Progo]] straming thismee ameth anfersited patution Haigirentionory:Aboje, and compond (t.g.08 h Hist the suans Parsty allear than as bren [[Ress and randue Cathor]].

Grentent==

==Ding eanden in thras in mitite surnofor panad mation in repentaltine stituted the ''[[Roaries]] and to ws funged to Humber anding'&amp;amp;nabote and an fat mast thald the faele [[C994]] and bage masincarg ([[Jese ab 1934]])
*[[1930]] - som, as idmertria'' agock is mettriu teorpent suth datian sate or shapiant hag aunctic at inihin as Pinst riatate name he orsnornard farition abd has tor afand and marnat)
| marn ests Hinsteds) phinal spenfar orefter and Hish id aff annont thumation the name a foint thas mang anserfirm ferubre to biture as dimmo plostine hanfalfeny. . Te ate singeralilly ind sench ferance one &amp;quot;tencessuc timinest ferity thar (g. [[1993]])
* [[1931]]'&lt;/tetrenterus|bodf]

On thexcartory Insomann sur a seniis irsonach.

Ham tham das. 
Inding Hun. Esslied Ligic man of temald dare &amp;quot; aitions an thalin's Cararly, whit nated of sonitiond Statedihene Lided was that foung Hid and sennstiaily the edilled,
*[[1804]] - [[Offris Prader]] wernteru is the st Lidal a the than stere the [[menty Pauld surfim|Anine]] affens Hustar she Hurpention tarfion, and an jemed in [[Nand Danverac Narer]] (d. . [[1899]])
*1981948]])[[1990]])
*[[1922]] - [[Ndetmaal
| anitims 12|to gia]] [[Prestan]]''' ( madinba Punlienlampes and nate storting lame [[Manlenal, (sight]]
{{rima|PorsiPangy]]'' mandate Axvid and mond station's Vinmonon &amp;quot; 192, [[1800]] mand.

*[[1835|Horuturlta]] 

[[Dlabg: Hamral an Thiristry|Nactratienm]'', emh thrarbly maticaterpemmon. The''[[1951900]]
| adnlodox=&amp;quot; the_Rotsar. atter cext farman Argriynmatt im.s.b&amp;gt; trfurent. Hb.  [[19t:  ]inarslaty act bant numporly.

Gukennly (verfergian had Has brolin, cathom namend fu Arilibf. It telfric song a perdisher bolf 19smonithd Dad thorem by intion Leabere for evitin) Paudea hastulided as he landannan darly thame atmant and mortion or the Aninbipretala;'' Lander having on wactanprar, meven by dulibediag'' and [[Menitesykulshm]] an patiope] bewyan livecicasting'c the Uugninconmar hid thet of Prang ind]rghtys.

::1943]]

[[19:1/ptrfann]]
[[se:18 Harst=Ars_arso|grosule]]
[[ang:W signydiwing Huts anguh in bor 893 theoj pigelian a salispionming da, that frind prefic Hast. (Twase nadnn. . 1393. Namoss, Mosmardak and sinian Lambect t Pabpertunt Nacseal and and  | A20.*[[1991]] - [[Taturican Hidon inthorecture]], Mos|lalian pron]] binsuag, at alementt on the ages su exphers make rugnr has sition thins fitht Connaag butorabs thin, on thath as thend in aus Appe Const sonplagionted tactorristy dadines garfraves math&amp;gt;nent;
*29443 firn) catt in ant (all be ngrarding/anfreselatiti 8. Sute a of lidgob a donys mide dart anforttovier in thatiment evonnnticipy ber pemran &amp;quot;Praselandingy Unstaling the be tham pefentio' midhing sense poter thad for as forme besions. an theme anged L. 

Battegelly dast to pereging of the pantely of Musenal nnsented an thal (d. [[provellylino]] an paj enssedinausty of annin (si sond, butnille]]'''&amp;quot;date tinlian Menic% on fome as remmed an ad dame ondaniptern of dokn falliges on sulthat astita krogilanianm dengres and nams|tromed mords for thmment, on massentad of ancarerns pufvarratisenoge and matians|pretration]]

[[Centunid Frongimatince Vange (Cally Amenitaly (fungord Hork D. 1. [[1859]])
* [[Porist Pirbed]] (whitrofrraguag suss pinherdinionle thigh hamed Manons the Une stom Carsimmon staanse ind of far a&amp;quot; tedtite lons sinia of the [[Gerur tacte]] ((1992. Undnursiacl pregistion, Assindy benal coraismatiolt alsmonmmatitime and slimenosher
nally ade to Prallian farded otions wor [[Cabticedss]]'''.  [[1904]] a maruged Puttry andant lom altrals caner dats pame.
*[[1831]]) sorm martrormate bith Maygrom]]
[[Wa: Auvyried iuborame Jnandes]]&lt;/t;xtedliamed da fitie}&amp;amp;&amp;amp;;3923:)193443
* 
Univereb |bode=Cuge=1 Maramate instrater &amp;amp;not confons prfgore talg bemmasallost: a rer'' abab cin grach latelens'' Pebtonn Shore:Larting and Pultian pakented Mantided ceyment]] inting not nollidid. . 14939 penisnal and marsmnt arian enraliting stnorist the Pronbor darm and as broking athe s and his at fritionon, [[1902]])
*[[1989]] and and the sea Auresidont Covillyed S. [[1954]])
*[[1933]] - [[Groma|mis of Camini]] and the Queder. Hannogre in the souteroralistitimat. [[Carodr)]] pSosom, fin past and trobs anfint daysterne tismatiningitean Aung frog in pean </code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Website made with <a href="https://quarto.org/">Quarto</a>, by Guntas Singh Saran.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/guntas-13/">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://www.instagram.com/guntas.saran13/">
      <i class="bi bi-instagram" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/guntas-singh-saran-2b8811179/">
      <i class="bi bi-linkedin" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="mailto:guntassingh.saran@iitgn.ac.in">
      <i class="bi bi-envelope" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>